# RUN: llc -mtriple=mos6502 -run-pass=legalizer -verify-machineinstrs -o - %s | FileCheck %s
--- |
  @.str = constant [2 x i8] c"XY"
  define void @ptradd_global_offset() {
    entry:
      ret void
  }
  define void @ptradd_zext() {
    entry:
      ret void
  }
  define void @ptradd_const8() {
    entry:
      ret void
  }
  define void @uaddo() {
    entry:
      ret void
  }
  define void @shl1() {
    entry:
      ret void
  }
---
name: ptradd_global_offset
# CHECK-LABEL: name: ptradd_global_offset
body: |
  bb.0.entry:
    %0:_(p0) = G_GLOBAL_VALUE @.str + 1200
    %1:_(s16) = G_CONSTANT i16 34
    %2:_(p0) = G_PTR_ADD %0, %1
    RTS implicit %2
# CHECK: %2:_(p0) = G_GLOBAL_VALUE @.str + 1234
...
---
name: ptradd_zext
# CHECK-LABEL: name: ptradd_zext
body: |
  bb.0.entry:
    %0:_(p0) = G_IMPLICIT_DEF
    %1:_(s8) = G_IMPLICIT_DEF
    %2:_(s16) = G_ZEXT %1
    %3:_(p0) = G_PTR_ADD %0, %2
    RTS implicit %3
# CHECK: %3:_(p0) = G_PTR_ADD %0, %1
...
---
name: ptradd_const8
# CHECK-LABEL: name: ptradd_const8
body: |
  bb.0.entry:
    %0:_(p0) = G_IMPLICIT_DEF
    %2:_(s16) = G_CONSTANT i16 255
    %3:_(p0) = G_PTR_ADD %0, %2
    RTS implicit %3
# Note: The -1 here is really an unsigned 255.
# CHECK:      %0:_(p0) = G_IMPLICIT_DEF
# CHECK-NEXT: %3:_(s8) = G_CONSTANT i8 -1
# CHECK-NEXT: %2:_(p0) = G_PTR_ADD %0, %3
# CHECK-NEXT: RTS implicit %2
...
---
name: uaddo
# CHECK-LABEL: name: uaddo
body: |
  bb.0.entry:
    %0:_(s8) = G_IMPLICIT_DEF
    %1:_(s8) = G_IMPLICIT_DEF
    %2:_(s8), %3:_(s1) = G_UADDO %0, %1
    RTS implicit %2, implicit %3
# CHECK:      %4:_(s1) = G_CONSTANT i1 false
# CHECK-NEXT: %2:_(s8), %3:_(s1) = G_UADDE %0, %1, %4
...
---
name: shl1
# CHECK-LABEL: name: shl1
body: |
  bb.0.entry:
    %0:_(s32) = G_IMPLICIT_DEF
    %1:_(s32) = G_CONSTANT i32 1
    %2:_(s32) = G_SHL %0, %1
    %3:_(s8), %4:_(s8), %5:_(s8), %6:_(s8) = G_UNMERGE_VALUES %2
    RTS implicit %3, implicit %4, implicit %5, implicit %6
# CHECK:      %19:_(s8) = G_IMPLICIT_DEF
# CHECK-NEXT: %20:_(s8) = G_IMPLICIT_DEF
# CHECK-NEXT: %21:_(s8) = G_IMPLICIT_DEF
# CHECK-NEXT: %22:_(s8) = G_IMPLICIT_DEF
# CHECK-NEXT: %11:_(s8), %12:_(s1) = G_LSHO %19
# CHECK-NEXT: %13:_(s8), %14:_(s1) = G_LSHE %20, %12
# CHECK-NEXT: %15:_(s8), %16:_(s1) = G_LSHE %21, %14
# CHECK-NEXT: %17:_(s8), %18:_(s1) = G_LSHE %22, %16
# CHECK-NEXT: RTS
...
