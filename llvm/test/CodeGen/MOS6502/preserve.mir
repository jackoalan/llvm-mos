# RUN: llc -mtriple=mos6502 -run-pass=postrapseudos -verify-machineinstrs -o - %s | FileCheck %s
---
name:            preserve_a
tracksRegLiveness: true
# CHECK-LABEL: name: preserve_a
body:             |
  bb.0.entry:
    liveins: $a, $y
    $x = COPY $y
    RTS implicit $a
# CHECK:      STabs $a, &_SaveA
# CHECK-NEXT: T_A $y
# CHECK-NEXT: $x = TA_
# CHECK-NEXT: $a = LDabs &_SaveA
# CHECK-NEXT: RTS
...
---
name:            preserve_x
tracksRegLiveness: true
# CHECK-LABEL: name: preserve_x
body:             |
  bb.0.entry:
    liveins: $x, $a
    SThs $a, 2
    RTS implicit $x
# CHECK:      STabs $x, &_SaveX
# CHECK-NEXT: TSX
# CHECK-NEXT: STidx $a, 258, $x
# CHECK-NEXT: $x = LDabs &_SaveX
# CHECK-NEXT: RTS
...
---
name:            preserve_y
tracksRegLiveness: true
# CHECK-LABEL: name: preserve_y
body:             |
  bb.0.entry:
    liveins: $y, $a, $zp_ptr_0
    STindirimm $a, $zp_ptr_0, 123
    RTS implicit $y
# CHECK:      STabs $y, &_SaveY
# CHECK-NEXT: $y = LDimm 123
# CHECK-NEXT: STyindirr $a, $zp_ptr_0, $y
# CHECK-NEXT: $y = LDabs &_SaveY
# CHECK-NEXT: RTS
...
